<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Invoice Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .navigation {
            background: #f8fafc;
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 24px;
            border: 2px solid #4f46e5;
            background: white;
            color: #4f46e5;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-btn:hover {
            background: #4f46e5;
            color: white;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #4f46e5;
            color: white;
        }

        .page {
            display: none;
            padding: 40px;
        }

        .page.active {
            display: block;
        }

        .form-section {
            margin-bottom: 30px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border-left: 4px solid #4f46e5;
            transition: transform 0.3s ease;
        }

        .form-section:hover {
            transform: translateY(-2px);
        }

        .section-title {
            font-size: 1.3em;
            color: #4f46e5;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
            transform: translateY(-1px);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .items-table th {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .items-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        .items-table tr:hover {
            background: #f8fafc;
        }

        .invoice-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            border-left: 4px solid #4f46e5;
            transition: transform 0.3s ease;
        }

        .invoice-card:hover {
            transform: translateY(-2px);
        }

        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .invoice-number {
            font-size: 1.2em;
            font-weight: 700;
            color: #4f46e5;
        }

        .invoice-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-paid {
            background: #d1fae5;
            color: #065f46;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-overdue {
            background: #fecaca;
            color: #991b1b;
        }

        .invoice-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .detail-label {
            font-weight: 600;
            color: #6b7280;
        }

        .detail-value {
            color: #111827;
        }

        .invoice-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .total-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
        }

        .total-row.final {
            font-size: 1.2em;
            font-weight: 700;
            color: #4f46e5;
            border-top: 2px solid #4f46e5;
            padding-top: 15px;
            margin-top: 15px;
        }

        .invoice-preview {
            background: white;
            padding: 40px;
            border-radius: 10px;
            margin-top: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            display: none;
        }

        .invoice-preview-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4f46e5;
        }

        .invoice-title {
            font-size: 2.5em;
            color: #4f46e5;
            font-weight: 700;
        }

        .invoice-preview-details {
            text-align: right;
        }

        .invoice-parties {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
        }

        .party-info {
            flex: 1;
        }

        .party-info h3 {
            color: #4f46e5;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .success-message {
            background: #d1fae5;
            color: #065f46;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #10b981;
        }

        .error-message {
            background: #fecaca;
            color: #991b1b;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ef4444;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
            border-left: 4px solid #4f46e5;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #4f46e5;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #6b7280;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            
            .invoice-parties {
                flex-direction: column;
                gap: 30px;
            }
            
            .invoice-preview-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .invoice-preview-details {
                text-align: left;
            }

            .nav-buttons {
                flex-direction: column;
                align-items: center;
            }

            .nav-btn {
                width: 100%;
                max-width: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Professional Invoice Management System</h1>
            <p>Create, manage, and track your invoices with ease</p>
        </div>

        <div class="navigation">
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showPage('create-invoice')">📋 Create Invoice</button>
                <button class="nav-btn" onclick="showPage('company-settings')">🏢 Company Settings</button>
                <button class="nav-btn" onclick="showPage('invoice-history')">📚 Invoice History</button>
            </div>
        </div>

        <!-- Create Invoice Page -->
        <div id="create-invoice" class="page active">
            <div class="invoice-form">
                <!-- Client Information -->
                <div class="form-section">
                    <h2 class="section-title">Client Information</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName">Client Name</label>
                            <input type="text" id="clientName" placeholder="Client Company Name">
                        </div>
                        <div class="form-group">
                            <label for="clientEmail">Email</label>
                            <input type="email" id="clientEmail" placeholder="client@example.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientAddress">Address</label>
                            <textarea id="clientAddress" rows="3" placeholder="Client Address"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="clientPhone">Phone</label>
                            <input type="tel" id="clientPhone" placeholder="+1 (555) 987-6543">
                        </div>
                    </div>
                </div>

                <!-- Invoice Details -->
                <div class="form-section">
                    <h2 class="section-title">Invoice Details</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="invoiceNumber">Invoice Number</label>
                            <input type="text" id="invoiceNumber" placeholder="INV-001">
                        </div>
                        <div class="form-group">
                            <label for="invoiceDate">Invoice Date</label>
                            <input type="date" id="invoiceDate">
                        </div>
                        <div class="form-group">
                            <label for="dueDate">Due Date</label>
                            <input type="date" id="dueDate">
                        </div>
                    </div>
                </div>

                <!-- Items Section -->
                <div class="form-section">
                    <h2 class="section-title">Invoice Items</h2>
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Quantity</th>
                                <th>Rate</th>
                                <th>Amount</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="itemsTableBody">
                            <tr>
                                <td><input type="text" placeholder="Item description" class="item-description"></td>
                                <td><input type="number" placeholder="1" class="item-quantity" min="1"></td>
                                <td><input type="number" placeholder="0.00" class="item-rate" step="0.01"></td>
                                <td class="item-amount">$0.00</td>
                                <td><button class="btn btn-danger" onclick="removeItem(this)">Remove</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" onclick="addItem()">Add Item</button>
                </div>

                <!-- Totals Section -->
                <div class="total-section">
                    <h2 class="section-title">Invoice Totals</h2>
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Tax Rate (%):</span>
                        <input type="number" id="taxRate" placeholder="0" min="0" max="100" step="0.01" style="width: 100px; margin-left: 10px;" oninput="calculateTotals()">
                    </div>
                    <div class="total-row">
                        <span>Tax Amount:</span>
                        <span id="taxAmount">$0.00</span>
                    </div>
                    <div class="total-row final">
                        <span>Total:</span>
                        <span id="total">$0.00</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="generateInvoice()">📋 Generate Invoice</button>
                    <button class="btn btn-secondary" onclick="saveInvoice()">💾 Save Invoice</button>
                    <button class="btn btn-secondary" onclick="resetForm()">🔄 Reset Form</button>
                </div>
            </div>

            <!-- Invoice Preview -->
            <div class="invoice-preview" id="invoicePreview">
                <div class="invoice-preview-header">
                    <div>
                        <div class="invoice-title">INVOICE</div>
                        <div id="previewCompanyName"></div>
                    </div>
                    <div class="invoice-preview-details">
                        <div><strong>Invoice #:</strong> <span id="previewInvoiceNumber"></span></div>
                        <div><strong>Date:</strong> <span id="previewInvoiceDate"></span></div>
                        <div><strong>Due Date:</strong> <span id="previewDueDate"></span></div>
                    </div>
                </div>

                <div class="invoice-parties">
                    <div class="party-info">
                        <h3>From:</h3>
                        <div id="previewCompanyInfo"></div>
                    </div>
                    <div class="party-info">
                        <h3>To:</h3>
                        <div id="previewClientInfo"></div>
                    </div>
                </div>

                <div class="invoice-items">
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Quantity</th>
                                <th>Rate</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody id="previewItemsBody">
                        </tbody>
                    </table>
                </div>

                <div class="invoice-totals" style="margin-left: auto; width: 300px;">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="previewSubtotal">$0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Tax:</span>
                        <span id="previewTax">$0.00</span>
                    </div>
                    <div class="total-row final">
                        <span>Total:</span>
                        <span id="previewTotal">$0.00</span>
                    </div>
                </div>

                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                    <button class="btn btn-primary" onclick="downloadPDF()">📥 Download PDF</button>
                    <button class="btn btn-secondary" onclick="printInvoice()">🖨️ Print Invoice</button>
                    <button class="btn btn-secondary" onclick="editInvoice()">✏️ Edit Invoice</button>
                </div>
            </div>
        </div>

        <!-- Company Settings Page -->
        <div id="company-settings" class="page">
            <div id="companyMessage"></div>
            
            <div class="form-section">
                <h2 class="section-title">Company Information</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="settingsCompanyName">Company Name *</label>
                        <input type="text" id="settingsCompanyName" placeholder="Your Company Name" required>
                    </div>
                    <div class="form-group">
                        <label for="settingsCompanyEmail">Email *</label>
                        <input type="email" id="settingsCompanyEmail" placeholder="company@example.com" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="settingsCompanyPhone">Phone</label>
                        <input type="tel" id="settingsCompanyPhone" placeholder="+1 (555) 123-4567">
                    </div>
                    <div class="form-group">
                        <label for="settingsCompanyWebsite">Website</label>
                        <input type="url" id="settingsCompanyWebsite" placeholder="https://www.yourcompany.com">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="settingsCompanyAddress">Address</label>
                        <textarea id="settingsCompanyAddress" rows="3" placeholder="Company Address"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="settingsCompanyTaxId">Tax ID</label>
                        <input type="text" id="settingsCompanyTaxId" placeholder="Tax ID Number">
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">Invoice Settings</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="defaultTaxRate">Default Tax Rate (%)</label>
                        <input type="number" id="defaultTaxRate" placeholder="0" min="0" max="100" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="invoicePrefix">Invoice Number Prefix</label>
                        <input type="text" id="invoicePrefix" placeholder="INV-">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="paymentTerms">Payment Terms</label>
                        <select id="paymentTerms">
                            <option value="30">Net 30</option>
                            <option value="15">Net 15</option>
                            <option value="7">Net 7</option>
                            <option value="0">Due on Receipt</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="currency">Currency</label>
                        <select id="currency">
                            <option value="USD">USD ($)</option>
                            <option value="EUR">EUR (€)</option>
                            <option value="GBP">GBP (£)</option>
                            <option value="INR">INR (₹)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                <button class="btn btn-success" onclick="saveCompanySettings()">💾 Save Settings</button>
                <button class="btn btn-secondary" onclick="loadCompanySettings()">🔄 Reset to Saved</button>
            </div>
        </div>

        <!-- Invoice History Page -->
        <div id="invoice-history" class="page">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalInvoices">0</div>
                    <div class="stat-label">Total Invoices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalRevenue">$0</div>
                    <div class="stat-label">Total Revenue</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="paidInvoices">0</div>
                    <div class="stat-label">Paid Invoices</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingInvoices">0</div>
                    <div class="stat-label">Pending Invoices</div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">Invoice History</h2>
                <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: center;">
                    <input type="text" id="searchInvoices" placeholder="Search invoices..." style="flex: 1;">
                    <select id="statusFilter">
                        <option value="">All Status</option>
                        <option value="paid">Paid</option>
                        <option value="pending">Pending</option>
                        <option value="overdue">Overdue</option>
                    </select>
                    <button class="btn btn-secondary" onclick="filterInvoices()">🔍 Filter</button>
                    <button class="btn btn-danger" onclick="clearInvoiceHistory()">🗑️ Clear History</button>
                </div>
                <div id="invoiceHistoryContainer"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        let invoiceData = {};
        let invoiceHistory = JSON.parse(localStorage.getItem('invoiceHistory')) || [];
        let companySettings = JSON.parse(localStorage.getItem('companySettings')) || {};

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadCompanySettings();
            loadInvoiceHistory();
            updateDashboardStats();
            
            // Set default dates
            document.getElementById('invoiceDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('dueDate').value = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            // Auto-generate invoice number
            document.getElementById('invoiceNumber').value = (companySettings.invoicePrefix || 'INV-') + Date.now().toString().slice(-6);
        });

        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            
            if (pageId === 'invoice-history') {
                loadInvoiceHistory();
                updateDashboardStats();
            }
        }

        // Calculate totals when items change
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('item-quantity') || e.target.classList.contains('item-rate')) {
                calculateItemAmount(e.target);
                calculateTotals();
            }
        });

        function calculateItemAmount(input) {
            const row = input.closest('tr');
            const quantity = row.querySelector('.item-quantity').value || 0;
            const rate = row.querySelector('.item-rate').value || 0;
            const amount = (quantity * rate).toFixed(2);
            row.querySelector('.item-amount').textContent = '$' + amount;
        }

        function calculateTotals() {
            let subtotal = 0;
            document.querySelectorAll('.item-amount').forEach(cell => {
                const amount = parseFloat(cell.textContent.replace('$', '')) || 0;
                subtotal += amount;
            });

            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const taxAmount = (subtotal * taxRate / 100);
            const total = subtotal + taxAmount;

            document.getElementById('subtotal').textContent = '$' + subtotal.toFixed(2);
            document.getElementById('taxAmount').textContent = '$' + taxAmount.toFixed(2);
            document.getElementById('total').textContent = '$' + total.toFixed(2);
        }

        // Add Product List to Company Settings
        function addProductToList() {
            const name = document.getElementById('productName').value.trim();
            const rate = parseFloat(document.getElementById('productRate').value);
            if (!name || isNaN(rate) || rate < 0) return;
            companySettings.products = companySettings.products || [];
            companySettings.products.push({ name, rate });
            saveCompanySettings();
            renderProductList();
            document.getElementById('productName').value = '';
            document.getElementById('productRate').value = '';
        }

        function renderProductList() {
            const list = document.getElementById('productList');
            list.innerHTML = '';
            (companySettings.products || []).forEach((p, i) => {
            const li = document.createElement('li');
            li.textContent = `${p.name} - $${p.rate.toFixed(2)}`;
            li.innerHTML += ` <button class="btn btn-danger" style="padding:2px 8px;font-size:12px;" onclick="removeProduct(${i})">Remove</button>`;
            list.appendChild(li);
            });
        }

        function removeProduct(index) {
            companySettings.products.splice(index, 1);
            saveCompanySettings();
            renderProductList();
        }

        // Add Item Row with Product Select
        function addItem() {
            const tableBody = document.getElementById('itemsTableBody');
            const newRow = tableBody.insertRow();
            let productOptions = '<option value="">Custom</option>';
            (companySettings.products || []).forEach((p, i) => {
            productOptions += `<option value="${i}">${p.name}</option>`;
            });
            newRow.innerHTML = `
            <td>
                <select class="item-product" onchange="selectProduct(this)">
                ${productOptions}
                </select>
                <input type="text" placeholder="Item description" class="item-description" style="margin-top:5px;">
            </td>
            <td><input type="number" placeholder="1" class="item-quantity" min="1"></td>
            <td><input type="number" placeholder="0.00" class="item-rate" step="0.01"></td>
            <td class="item-amount">$0.00</td>
            <td><button class="btn btn-danger" onclick="removeItem(this)">Remove</button></td>
            `;
            calculateTotals();
        }

        function selectProduct(select) {
            const idx = select.value;
            const row = select.closest('tr');
            if (idx !== '') {
            const product = companySettings.products[idx];
            row.querySelector('.item-description').value = product.name;
            row.querySelector('.item-rate').value = product.rate;
            calculateItemAmount(row.querySelector('.item-rate'));
            calculateTotals();
            } else {
            row.querySelector('.item-description').value = '';
            row.querySelector('.item-rate').value = '';
            calculateItemAmount(row.querySelector('.item-rate'));
            calculateTotals();
            }
        }

        // Add product fields to Company Settings page after DOMContentLoaded
        document.addEventListener('DOMContentLoaded', function() {
            const companySettingsDiv = document.getElementById('company-settings');
            if (!document.getElementById('productSection')) {
            const productSection = document.createElement('div');
            productSection.className = 'form-section';
            productSection.id = 'productSection';
            productSection.innerHTML = `
                <h2 class="section-title">Products List</h2>
                <div class="form-row">
                <div class="form-group">
                    <label for="productName">Product Name</label>
                    <input type="text" id="productName" placeholder="Product Name">
                </div>
                <div class="form-group">
                    <label for="productRate">Rate</label>
                    <input type="number" id="productRate" placeholder="0.00" step="0.01" min="0">
                </div>
                <div class="form-group" style="align-self: flex-end;">
                    <button class="btn btn-success" onclick="addProductToList()">Add Product</button>
                </div>
                </div>
                <ul id="productList" style="margin-top:15px;"></ul>
            `;
            companySettingsDiv.insertBefore(productSection, companySettingsDiv.children[1]);
            }
            renderProductList();
        });